
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center">

  <!-- âœ… Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„ÙƒÙŠØ±ÙÙŠ -->
  <div class="bg-gradient-to-r from-purple-600 to-blue-500 text-center w-full max-w-3xl mt-6 p-6 rounded-3xl shadow-lg">
    <h1 class="text-3xl font-bold">test</h1>
    <p class="text-xl mt-2">Quiz</p>
  </div>

  <!-- âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ -->
  <div id="classSelection" class="text-center mt-10">
    <h2 class="text-2xl font-bold mb-4">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</h2>
    <select id="classSelect" class="text-black p-2 rounded">
      <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>
      <option value="g1">Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option value="g2">ØªØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option value="g3">ØªØ§Ù„ØªØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
      <option value="s1">Ø£ÙˆÙ„Ù‰ Ø«Ø§Ù†ÙˆÙŠ</option>
      <option value="s2">ØªØ§Ù†ÙŠØ© Ø«Ø§Ù†ÙˆÙŠ</option>
      <option value="s3">ØªØ§Ù„ØªØ© Ø«Ø§Ù†ÙˆÙŠ</option>
    </select>
    <button id="startBtn" class="bg-blue-600 px-4 py-2 rounded ml-2">Ø§Ø¨Ø¯Ø£</button>
  </div>

  <!-- âœ… Ø§Ù„ÙƒÙˆÙŠØ² -->
  <div id="quizSection" class="hidden w-full max-w-3xl mt-10">
    <div class="mb-4">
      <input id="studentName" placeholder="Ø§Ù„Ø§Ø³Ù…" class="p-2 text-black rounded w-1/2 mb-2"><br>
      <input id="studentPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†" class="p-2 text-black rounded w-1/2">
    </div>
    <form id="quizForm" class="space-y-4"></form>
    <button id="submitBtn" class="bg-green-600 px-4 py-2 rounded mt-4">Ø¥Ø±Ø³Ø§Ù„</button>
    <div id="result" class="mt-6 text-xl font-bold"></div>
  </div>

  <!-- âœ… Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ± -->
  <a href="https://wa.me/2010865" target="_blank" class="fixed bottom-6 right-6 bg-green-600 hover:bg-green-700 text-white px-5 py-3 rounded-full shadow-lg transition transform hover:scale-105">
    ğŸ’¬ ØªÙˆØ§ØµÙ„ Ù…Ø¹
  </a>
  <!-- âœ… Ø§Ù„ÙÙˆØªØ± Ø§Ù„Ø£Ø³ÙˆØ¯ (ÙƒÙŠØ±ÙÙŠ) -->
<a href="https://wa.me/201094724932" target="_blank" class="w-full flex flex-col items-center justify-center text-center mt-10 mb-4">
  <div class="bg-black text-white py-4 px-6 rounded-3xl shadow-lg w-64 hover:bg-gray-800 transition cursor-pointer">
    <p class="font-bold text-lg">ØµÙÙ…Ù… Ø¨ÙˆØ§Ø³Ø·Ø© Boda</p>
    <p class="text-sm text-gray-300 mt-1">Ø§Ù†Ù‚Ø± Ù„Ù„ØªÙˆØ§ØµÙ„</p>
  </div>
</a>
  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxIhUQkaU1QQS1uZLiVrfZzu9WmlpL_Ch6LhKQmgt4_IXceKar2po_jg7-RzNsV2ATr/exec";

    let questions = [];
    let correctAnswers = {};
    let explanations = {};
    let selectedClass = "";

    const classNames = {
      g1: "Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ",
      g2: "ØªØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ",
      g3: "ØªØ§Ù„ØªØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ",
      s1: "Ø£ÙˆÙ„Ù‰ Ø«Ø§Ù†ÙˆÙŠ",
      s2: "ØªØ§Ù†ÙŠØ© Ø«Ø§Ù†ÙˆÙŠ",
      s3: "ØªØ§Ù„ØªØ© Ø«Ø§Ù†ÙˆÙŠ"
    };

    document.getElementById("startBtn").addEventListener("click", async () => {
      selectedClass = document.getElementById("classSelect").value;
      if (!selectedClass) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ");

      const qSheet = `questions_${selectedClass}`;

      let res = await fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify({
          type: "getQuestions",
          classSheet: qSheet
        })
      });

      questions = await res.json();
      showQuestions();
      document.getElementById("classSelection").classList.add("hidden");
      document.getElementById("quizSection").classList.remove("hidden");
    });

    function showQuestions() {
      const form = document.getElementById("quizForm");
      form.innerHTML = "";
      questions.forEach(q => {
        correctAnswers[q.id] = q.correct;
        explanations[q.id] = q.explanation;

        let html = `
          <div class="card bg-gray-800 p-4 rounded-xl">
            <p class="font-bold mb-2">${q.question}</p>
            ${q.choices.map(c => `
              <label class="block"><input type="radio" name="${q.id}" value="${c}"> ${c}</label>
            `).join("")}
          </div>
        `;
        form.innerHTML += html;
      });
    }

    document.getElementById("submitBtn").addEventListener("click", async (e) => {
      e.preventDefault();
      const name = document.getElementById("studentName").value.trim();
      const phone = document.getElementById("studentPhone").value.trim();
      if (!name || !phone) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†");

      let score = 0, wrong = [], total = questions.length;
      questions.forEach(q => {
        const selected = document.querySelector(`input[name="${q.id}"]:checked`);
        const card = document.querySelector(`input[name="${q.id}"]`).closest(".card");
        const all = document.querySelectorAll(`input[name="${q.id}"]`);

        all.forEach(opt => {
          let label = opt.parentElement;
          label.style.color = "#fff";
          if (opt.value === q.correct) label.style.color = "lightgreen";
          if (selected && opt === selected && selected.value !== q.correct) label.style.color = "red";
        });

        if (selected && selected.value === q.correct) score++;
        else {
          wrong.push(q.id);
          const exp = document.createElement("div");
          exp.classList.add("explanation");
          exp.style.color = "#ffeb3b";
          exp.style.marginTop = "5px";
          exp.innerHTML = `<b>Ø§Ù„Ø´Ø±Ø­:</b> ${q.explanation}`;
          card.appendChild(exp);
        }
      });

      document.getElementById("result").innerHTML = `âœ… Ù†ØªÙŠØ¬ØªÙƒ: ${score} / ${total}`;

      await fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify({
          type: "saveResult",
          className: classNames[selectedClass],
          name, phone, score, total, wrong
        })
      });
    });
  </script>
</body>
</html>
